"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[29015],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return h}});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=n.createContext({}),s=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=s(e.components);return n.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,u=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(r),h=o,m=d["".concat(u,".").concat(h)]||d[h]||p[h]||a;return r?n.createElement(m,i(i({ref:t},c),{},{components:r})):n.createElement(m,i({ref:t},c))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=r[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},45335:function(e,t,r){r.r(t),r.d(t,{assets:function(){return c},contentTitle:function(){return u},default:function(){return h},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return p}});var n=r(83117),o=r(80102),a=(r(67294),r(3905)),i=["components"],l={},u="Migration Notes",s={unversionedId:"charts/enterprise/nextcloud/migration_guide",id:"charts/enterprise/nextcloud/migration_guide",title:"Migration Notes",description:"This guide is provided as a resource to help taken from our Discord, but since 15.X is a breaking change",source:"@site/docs/charts/enterprise/nextcloud/migration_guide.md",sourceDirName:"charts/enterprise/nextcloud",slug:"/charts/enterprise/nextcloud/migration_guide",permalink:"/docs/charts/enterprise/nextcloud/migration_guide",draft:!1,editUrl:"https://github.com/truecharts/website/tree/master/docs/charts/enterprise/nextcloud/migration_guide.md",tags:[],version:"current",frontMatter:{},sidebar:"chartsSidebar",previous:{title:"Important Notes",permalink:"/docs/charts/enterprise/nextcloud/installation_notes"},next:{title:"Input Validation",permalink:"/docs/charts/enterprise/nextcloud/validation"}},c={},p=[],d={toc:p};function h(e){var t=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"migration-notes"},"Migration Notes"),(0,a.kt)("p",null,"This guide is provided as a resource to help taken from our Discord, but since 15.X is a breaking change\nthere's no guarantees this will work, and you may have to install fresh"),(0,a.kt)("p",null,'We want to highlight that this is considered a completely new App, hence the "breaking change".\nFor the best stability we would advice people to reinstall (with the option to save the users data).'),(0,a.kt)("p",null,"While we try to help people through migration and even have added some automated migration tooling,\nwe cannot guarantee migration with breaking changes like these."),(0,a.kt)("p",null,"The correct troubleshooting steps would be:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},'Remove any mention of "nextcloud_datadir" either in env-vars or config.php (if you manually added or altered it), we never supported this due to us expecting this change long beforehand'),(0,a.kt)("li",{parentName:"ul"},"Remove any custom storage"),(0,a.kt)("li",{parentName:"ul"},'Ensure config is set to "PVC"'),(0,a.kt)("li",{parentName:"ul"},"Add ",(0,a.kt)("inlineCode",{parentName:"li"},"127.0.0.1")," to the TRUSTED_PROXY setting like this: ",(0,a.kt)("inlineCode",{parentName:"li"},"172.16.0.0/16 127.0.0.1")),(0,a.kt)("li",{parentName:"ul"},"Stop and Start the old version to double-ensure the settings are applied"),(0,a.kt)("li",{parentName:"ul"},"Apply the update"),(0,a.kt)("li",{parentName:"ul"},"Wait for a good while (go grab lunch, eat it and drink a coffee afterwards)"),(0,a.kt)("li",{parentName:"ul"},"Check if it worked out")),(0,a.kt)("p",null,"If not:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Manually ensure your nextcloud data structure is correct inside the App in both /var/www/html and /var/www/html/data"),(0,a.kt)("li",{parentName:"ul"},"Double check if data directory is not set to anything other than /var/www/html/data (not set at-all is fine though)"),(0,a.kt)("li",{parentName:"ul"},"Restart")))}h.isMDXComponent=!0}}]);