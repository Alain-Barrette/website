"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9872],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return c}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=u(n),c=r,h=m["".concat(s,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(h,l(l({ref:t},p),{},{components:n})):a.createElement(h,l({ref:t},p))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1048:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return d}});var a=n(3117),r=n(102),i=(n(7294),n(3905)),l=["components"],o={},s="Questions.yaml",u={unversionedId:"manual/development/questions-yaml",id:"manual/development/questions-yaml",title:"Questions.yaml",description:"Questions.yaml is the file which get rendered by TrueNAS to create the UI. When not creating new charts, most of what this project does is stitching together questions.yaml files to turn existing Helm Charts into Apps.",source:"@site/docs/manual/development/questions-yaml.md",sourceDirName:"manual/development",slug:"/manual/development/questions-yaml",permalink:"/fr/docs/manual/development/questions-yaml",draft:!1,editUrl:"https://github.com/truecharts/pub/docs/manual/development/questions-yaml.md",tags:[],version:"current",frontMatter:{},sidebar:"manualSidebar",previous:{title:"Portal Button",permalink:"/fr/docs/manual/development/portal"},next:{title:"Services",permalink:"/fr/docs/manual/development/services"}},p={},d=[{value:"Syntax",id:"syntax",level:3},{value:"Question Variable Reference",id:"question-variable-reference",level:4},{value:"Subquestions",id:"subquestions",level:5},{value:"Special Questions",id:"special-questions",level:5},{value:"Standardised questions.yaml sections",id:"standardised-questionsyaml-sections",level:3},{value:"Groups",id:"groups",level:5},{value:"General Configuration options",id:"general-configuration-options",level:5},{value:"Security Context Configuration options",id:"security-context-configuration-options",level:5}],m={toc:d};function c(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"questionsyaml"},"Questions.yaml"),(0,i.kt)("p",null,"Questions.yaml is the file which get rendered by TrueNAS to create the UI. When not creating new charts, most of what this project does is stitching together questions.yaml files to turn existing Helm Charts into Apps."),(0,i.kt)("h3",{id:"syntax"},"Syntax"),(0,i.kt)("p",null,"In this document we give you a short reference guide (ported from IX Official) which lays out the settings available in questions.yaml."),(0,i.kt)("h4",{id:"question-variable-reference"},"Question Variable Reference"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Variable"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Required"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"variable"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"define the variable name specified in the ",(0,i.kt)("inlineCode",{parentName:"td"},"values.yaml"),"file.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"label"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"define the UI label.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"description"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specify the description of the variable.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"group"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"group questions by input value.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema"),(0,i.kt)("td",{parentName:"tr",align:null},"dictionary"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"specify schema details for the ",(0,i.kt)("inlineCode",{parentName:"td"},"variable"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.type"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"specify type of value for ",(0,i.kt)("inlineCode",{parentName:"td"},"variable")," (current supported types are string, int, boolean, path, hostpath, list, dict, ipaddr, and cron).")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.required"),(0,i.kt)("td",{parentName:"tr",align:null},"bool"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"define if the variable is required or not (true \\ false), defaults to false")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.default"),(0,i.kt)("td",{parentName:"tr",align:null},"object"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specify the default value.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.min_length"),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"min character length for string type variable.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.max_length"),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"max character length for string type variable.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.min"),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"min integer length.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.max"),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"max integer length.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.enum"),(0,i.kt)("td",{parentName:"tr",align:null},"[]dictionary"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specify the options when the variable type is ",(0,i.kt)("inlineCode",{parentName:"td"},"string"),", for example, ",(0,i.kt)("br",null),(0,i.kt)("br",null),"enum:",(0,i.kt)("br",null),' - value: "RollingUpdate" ',(0,i.kt)("br",null),"\xa0","\xa0",'description: "Create new pods and then kill old ones"',(0,i.kt)("br",null),' - value: "Recreate"',(0,i.kt)("br",null),"\xa0","\xa0",'description: "Kill existing pods before creating new ones"')),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.valid_chars"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"regular expression for input chars validation.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.subquestions"),(0,i.kt)("td",{parentName:"tr",align:null},"[]subquestion"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"add an array of subquestions.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.show_if"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"show current variable if condition specified is true, for example ",(0,i.kt)("inlineCode",{parentName:"td"},'show_if: [["workloadType", "=", "CronJob"]]'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.show_subquestions_if"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"show subquestions if is true or equal to one of the options. for example ",(0,i.kt)("inlineCode",{parentName:"td"},'show_subquestion_if: "static"'),". system will convert this to the filters format specifid for ",(0,i.kt)("inlineCode",{parentName:"td"},"shcema.show_if")," automatically.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.attrs"),(0,i.kt)("td",{parentName:"tr",align:null},"[]variables"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specified when ",(0,i.kt)("inlineCode",{parentName:"td"},"schema.type")," is dictionary to declare attributes allowed in the dictionary.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.items"),(0,i.kt)("td",{parentName:"tr",align:null},"[]variables"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specified when ",(0,i.kt)("inlineCode",{parentName:"td"},"schema.type")," is list to declare attributes allowed in the list.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.private"),(0,i.kt)("td",{parentName:"tr",align:null},"bool"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specified for declaring information sensitive fields.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"schema.null"),(0,i.kt)("td",{parentName:"tr",align:null},"bool"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"specifies if the value for the variable can be null. defaults to false.")))),(0,i.kt)("h5",{id:"subquestions"},"Subquestions"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"subquestions[]")," cannot contain ",(0,i.kt)("inlineCode",{parentName:"p"},"subquestions")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"show_subquestions_if")," keys, but all other keys in the above table are supported. Also variables having ",(0,i.kt)("inlineCode",{parentName:"p"},"schema.type")," list do not support ",(0,i.kt)("inlineCode",{parentName:"p"},"subquestions"),"."),(0,i.kt)("h5",{id:"special-questions"},"Special Questions"),(0,i.kt)("p",null,"There are some novel cases where we would like to provide ability to configure / manage resources for workloads with getting some data from system dynamically.\nSo a chart can specify certain actions to be performed by the system for a variable by defining a reference. An example better illustrates this concept:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'- variable: volume\n  label: "Volume"\n  schema:\n    type: dict\n    $ref:\n      - "normalize/ixVolume"\nattrs:\n      - variable: mountPath\n        label: "Mount Path"\n        description: "Path where the volume will be mounted inside the pod"\n        schema:\n          type: path\n          required: true\n      - variable: datasetName\nlabel: "Dataset Name"\n        schema:\n          type: string\n          required: true\n')),(0,i.kt)("p",null,"In the above variable we define a ",(0,i.kt)("inlineCode",{parentName:"p"},"$ref")," in schema which specifies that the system should take some action for normalising the value specified for the variable.\nIn this specific case, ",(0,i.kt)("inlineCode",{parentName:"p"},"ix_volume")," is a concept introduced where we recommend using a volume which we are able to rollback automatically on chart release rollback. In essence,\nit is just a ",(0,i.kt)("inlineCode",{parentName:"p"},"hostPath")," volume for which the system automatically creates the dataset specified.\nWe have following types of actions supported in ",(0,i.kt)("inlineCode",{parentName:"p"},"$ref")," right now:\n1) definitions\n2) normalize\nFor (1), system will automatically update schema for a particular definition. For example,"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'- variable: hostInterface\n  description: "Please specify host interface"\nlabel: "Host Interface"\n  schema:\n    type: string\n    required: true\n    $ref:\n      - "definitions/interface"\n')),(0,i.kt)("p",null,"System will automatically populate available interfaces for the user based on what interfaces are available on the system.\nFor (2), system will normalize values or perform some actions as discussed above."),(0,i.kt)("h3",{id:"standardised-questionsyaml-sections"},"Standardised questions.yaml sections"),(0,i.kt)("p",null,"To minimise the maintenance load of our App collection, we always aim to standardise as much as possible. The same goes for questions.yaml. Included here are some code standardised code-snippets that are expected to be included in every App.\nBe aware that sometimes specific functions might or might not completely function. Leaving them out would, however, everely increase the maintenance load and often said functionality will be added in the common-chart later on anyway."),(0,i.kt)("h5",{id:"groups"},"Groups"),(0,i.kt)("p",null,"To make sure all apps stay somewhat the same, we use a list of standardised groups for the groups section. Please make sure to use these groups in your Apps:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'groups:\n  - name: "Container Image"\n    description: "Image to be used for container"\n  - name: "Workload Configuration"\n    description: "Configure workload deployment"\n  - name: "Configuration"\n    description: "additional container configuration"\n  - name: "Networking"\n    description: "Configure Network and Services for container"\n  - name: "Storage"\n    description: "Persist and share data that is separate from the lifecycle of the container"\n  - name: "Resources and Devices"\n    description: "Specify resources/devices to be allocated to workload"\n  - name: "Ingress Configuration"\n    description: "Ingress Configuration"\n  - name: "Security"\n    description: "Configure security context"\n  - name: "Advanced"\n    description: "Advanced Configuration"\n  - name: "WARNING"\n    description: "WARNING"\n')),(0,i.kt)("h5",{id:"general-configuration-options"},"General Configuration options"),(0,i.kt)("p",null,"These options are always* included because almost every chart (eventually) has a use for them and/or other parts of the common chart depend on them.\nThey are called general options, because they affect the basic functionalities of a chart. For example: Custom User environment variables, permissions and timezones."),(0,i.kt)("p",null,"*",(0,i.kt)("inlineCode",{parentName:"p"},"PUID"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"PGID"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"UMASK")," are only included when they are needed."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'  - variable: env\n    group: "Configuration"\n    label: "Image Environment"\n    schema:\n      additional_attrs: true\n      type: dict\n      attrs:\n        - variable: TZ\n          label: "Timezone"\n          schema:\n            type: string\n            default: "Etc/UTC"\n            $ref:\n        - "definitions/timezone"\n        - variable: PUID\n          label: "PUID"\n          description: "Sets the PUID env var for LinuxServer.io (compatible) containers"\n          schema:\n            type: int\n            default: 568\n        - variable: PGID\n          label: "PGID"\n          description: "Sets the PGID env var for LinuxServer.io (compatible) containers"\n          schema:\n            type: int\n            default: 568\n        - variable: UMASK\n          label: "UMASK"\n          description: "Sets the UMASK env var for LinuxServer.io (compatible) containers"\n          schema:\n            type: string\n            default: "002"\n\n  # Configure Custom Enviroment Variables\n  - variable: environmentVariables\n    label: "Image environment"\n    group: "Configuration"\n    schema:\n      type: list\n      default: []\n      items:\n        - variable: environmentVariable\n          label: "Environment Variable"\n          schema:\n            type: dict\n            attrs:\n              - variable: name\n                label: "Name"\n                schema:\n                  type: string\n              - variable: value\n                label: "Value"\n                schema:\n                  type: string\n')),(0,i.kt)("h5",{id:"security-context-configuration-options"},"Security Context Configuration options"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'  # Enable privileged\n  - variable: securityContext\n    group: "Security"\n    label: "Security Context"\n    schema:\n      additional_attrs: true\n      type: dict\n      attrs:\n        - variable: privileged\n          label: "Enable privileged mode for Common-Chart based charts"\n          schema:\n            type: boolean\n            default: false\n  # Set Pod Security Policy\n  - variable: podSecurityContext\n    group: "Security"\n    label: "Pod Security Context"\n    schema:\n      additional_attrs: true\n      type: dict\n      attrs:\n        - variable: runAsNonRoot\n          label: "runAsNonRoot"\n          schema:\n            type: boolean\n            default: true\n        - variable: runAsUser\n          label: "runAsUser"\n          description: "The UserID of the user running the application"\n          schema:\n            type: int\n            default: 568\n        - variable: runAsGroup\n          label: "runAsGroup"\n          description: The groupID this App of the user running the application"\n          schema:\n            type: int\n            default: 568\n        - variable: fsGroup\n          label: "fsGroup"\n          description: "The group that should own ALL storage."\n          schema:\n            type: int\n            default: 568\n        - variable: fsGroupChangePolicy\n          label: "When should we take ownership?"\n          schema:\n            type: string\n            default: "OnRootMismatch"\n            enum:\n              - value: "OnRootMismatch"\n                description: "OnRootMismatch"\n              - value: "Always"\n                description: "Always"\n')))}c.isMDXComponent=!0}}]);